{
    "contents" : "# regression subset selection with leaps and bounce algorithm-------------------------\n\n## with code #\nlibrary(leaps)\nregsubsets_out <- regsubsets(day_falling ~. , data = ophi_code,\n                             nbest = 1, method = \"backward\", nvmax = NULL)\nplot(regsubsets_out, scale = \"adjr2\", main = \"Adjusted R^2\")\n\n# best model at each variable number\nsummary_out <- summary(regsubsets_out, matrix.logical=TRUE)\nmodels_df <- as.data.frame(summary_out$outmat)\n\n# exchange factor level names with variable names\nlibrary(stringr)\nshorten <- function(x) {\n        str_sub(x, 1, str_length(x) - 1)\n}\noriginal_names <- unlist(lapply(names(models_df), shorten))\n\n# get indices of variables for all models\nget_ind <- function(x){\n        which(as.logical(x))\n}\nall_mod_ind <- apply(models_df, 1, get_ind)\n\nnumber_snp <- vector()\nfor (i in 1:length(all_mod_ind)) {\n        number_snp[i] <- length(unique(original_names[all_mod_ind[[i]]]))\n}\n\n# plot --------------------------------------------------------------------------\n# number of snps per model\nlibrary(scales)\npdf(\"leapsbounce.pdf\", width=7, height=5)\n\npar(mar = c(6,6,5,5))\nplot(summary_out$adjr2, \n     bty = \"n\", axes = F, xlab = \"\", ylab = \"\", pch=16, \n     ylim = c(0, 0.55))\naxis(2, at=c(seq(from=0,to=0.5,by=0.1)),las=1, cex.axis = 1.2)\nmtext(expression(\"Adjusted\" ~ italic(r)^{2}), 2,line= 4, cex = 1.2)\naxis(1, at=c(seq(1,181, by = 20),las=1), cex.axis = 1.2)\nmtext(\"Contrasts\", 1,line= 1 ,at=-22, cex = 1.2)\n\n\n# axis(1,0:180,line=1,col=\"red\",col.ticks=\"red\",col.axis=\"red\")\naxis(1,at=c(seq(from=1,to=181,by=10)),\n     labels=number_snp[seq(from = 1, to = 181, by = 10)],\n     line=2.5, cex.axis = 1.2)\nmtext(\"SNPs\", 1,line= 3.5 ,at=-16, cex = 1.2)\n# segments, arrows\narrows(89,summary_out$adjr2[89],89,0, lty = 1, lwd = 2, col = \"black\", length = 0.15)\npoints(89, summary_out$adjr2[89], col = \"red\", pch = 16, cex = 1)\n# abline(v = 89, lty = 5, lwd = 2) # 89 factor levels\n# text(132, 0.485,\"Lowest RSS model \\n(89 factor level comparisons,\\n66 SNPÂ´s)\", col = \"blue\")\ntext(89, 0.525,\"Lowest RSS model \\n(66 SNPs, 89 Contrasts)\", col = \"black\", cex = 1.2)\n\ndev.off()\n  \n\n# ggvis\nlibrary(ggvis)\ndf_lb <- data.frame(lev = 1:length(summary_out$adjr2), snp = number_snp,\n                    adjr2 = summary_out$adjr2)\n\ndf_lb %>% \n        ggvis(x = ~lev, y = ~adjr2) %>%\n        layer_points() %>%\n        add_axis(\"x\") %>%\n        add_axis(\"x\", offset = 50, grid = FALSE, labels = listsnp)\n\n\n\nlibrary(broom)\ntest <- tidy(mod_aic_code)\n\n\n\n\n\n# percentage of snps from aic model in leaps bounce best model\n# snps in best leaps bounce model\nsnp_lb_code <- unique(original_names[unlist(all_mod_ind[89])])\n# snps in AIC\nsnp_aic_code <- names(df_aic_code)[-1]\n\n# percentage of snps from best AIC model in best lb model\nsum(snp_aic_code %in% snp_lb_code)/49\n\nwhich.max(summary_out$adjr2)\nbest_lp <- as.data.frame(summary_out$which[88,])\nnames(best_lp) <- \"in\"\nbest_lp <- best_lp[best_lp[1] == TRUE]\n\nplot(summary.out$rss)\nplot(summary.out$rsq)\n\n## with additive #\nregsubsets_out <- regsubsets(day_falling ~. , data = ophi_add,\n                             nbest = 1, method = \"backward\", nvmax = NULL)\nregsubsets_out\nplot(regsubsets_out, scale = \"adjr2\", main = \"Adjusted R^2\")\n\n# best model at each variable number\nsummary.out <- summary(regsubsets_out, matrix.logical=TRUE)\nas.data.frame(summary.out$outmat)\nplot(summary.out$adjr2)\nplot(summary.out$rss)\nplot(summary.out$rsq)\n",
    "created" : 1422968739070.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "872156120",
    "id" : "E92C52C",
    "lastKnownWriteTime" : 1423754191,
    "path" : "C:/Users/Martin/Studium/projects/ophionotus/leapsbounce.R",
    "project_path" : "leapsbounce.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}
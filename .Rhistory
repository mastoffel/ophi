# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.2),
alpha = 1, size = 0.7, color = "green",
fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
theme(plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.6, size = 0.7, color = "gray",
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
theme(plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.6, size = 0.7, color = "gray") +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
theme(plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.6, size = 0.7, color = "black") +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
theme(plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.6, size = 0.7, color = "#E69F00") +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
theme(plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.2),
alpha = 1, size = 0.5, color = "green") +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
theme(plot.margin=unit(c(0.2,0.2,0.2,0.2), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "green") +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "green") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 5, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "orange") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 7, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "orange") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="------", size= 6, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "orange") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="----", size= 7, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "orange") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="---", size= 7, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "orange") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="----", size= 6, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "orange") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
get_all_plots <- function(model_df) {
all_plots <- list()
for(i in 2:ncol(model_df)) {
snp <- names(model_df)[i]
p <- ggplot(model_df, aes_string(x = snp, y = "day_falling")) +
theme_bw(base_size = 10) +
geom_boxplot() +
# fill = NA, shape = 21) +
stat_summary(fun.y = "mean", geom = "text",
label="----", size= 5, color= "blue")  +
geom_point(position = position_jitter(width = 0.2),
alpha = 0.7, size = 0.5, color = "orange") +
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1), "cm"),
axis.title.y = element_blank())
#stat_summary(fun.y=mean, colour="darkred", geom="point",
#shape=18, size=3,show_guide = FALSE)
nam <- paste("plot_", i, sep = "")
# assign(nam, p)
all_plots[[i-1]] <- p
}
return(all_plots)
}
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[1:24], cols = 4)
all_plots <- get_all_plots(df_aic_code)
multiplot(plotlist = all_plots[25:49], cols = 4)
multiplot(plotlist = all_plots[25:49], cols = 5)
multiplot(plotlist = all_plots[1:49], cols = 7)
library(MASS)
?stepAIC
runif(100,0,1)
install.packages("rms")
setwd("C:/Users/Martin/Studium/projects/tree")
2^7
View(all_names)
?read.table
raw <- read.table("raw.csv", header = TRUE)
raw <- read.table("raw.csv")
raw <- read.csv("raw.csv", header = TRUE)
head(raw)
raw <- read.csv("raw.csv", header = TRUE)[1:288, ]
View(res)
View(raw)
row.names(raw)
head(raw)
raw <- read.csv("raw.csv", row.names = 1, header = TRUE)[1:288, ]
names(raw)
row.names(raw)
df_aic_code
head(df_aic_code)
ped_df <- data("Individual ID" = row.names(raw),"Phenotype" = df_aic_code$day_falling)
row.names(raw)
ped_df <- data.frame("Individual ID" = row.names(raw),"Phenotype" = df_aic_code$day_falling)
ped <- cbind(ped_df, raw)
tbl_df(ped)
library(dplyr)
tbl_df(ped)
write.table(ped, "ped.txt")
?write.table
write.table(ped, "ped.txt", row.names = FALSE)
View(df_aic_code)
ophi_code_can <- ophi_code[1:64]
ophi_code_nocan <- ophi_code[65:100]
ophi_code_can <- ophi_code[1:65]
ophi_code_nocan <- ophi_code[c(1, 66:100)]
mod1 <- glm(day_falling ~ ., data = ophi_code_can)
mod2 <- glm(day_falling ~ ., data = ophi_code_nocan)
summary(mod1)
summary(mod2)
anova(mod1, mod2)
summary(anova(mod1, mod2))
raw <- read.csv("raw.csv", row.names = 1, header = TRUE)[1:288, ]
row.names(raw)
library(stringr)
str_c(row.names(raw))
?stringr
?str_replace
str_replace_all(row.names(raw), "Ophi ", "")
row.names(raw) <- str_replace_all(row.names(raw), "Ophi ", "")
row.names(raw)[14] <- 14
row.names(raw)
nobs <- length(row.names(raw))
rep(0, nobs)
ped_temp <- data.frame("FID" = row.names(raw), "IID" = row.names(raw), "PatID" = rep(0, nobs),
"MatID" = rep(0, nobs), "Sex" = rep(0, nobs))
ped_temp <- data.frame("FID" = row.names(raw), "IID" = row.names(raw), "PatID" = rep(0, nobs),
"MatID" = rep(0, nobs), "Sex" = rep(0, nobs), "Phenotype" = ophi_code$day_falling)
ped <- cbind(ped, raw)
ped <- cbind(ped_temp, raw)
write.table(ped, "ophi.ped", row.names = FALSE)
map <- data.frame("Chr" = rep(0, nobs), "FID" = row.names(raw), "gendist" = rep(0, nobs), "snppos" = rep(-1, nobs) )
write.table(map, "ophi.map", row.names = FALSE)
row.names(raw)
ped_temp <- data.frame("FID" = as.numeric(row.names(raw)), "IID" = as.numeric(row.names(raw)), "PatID" = rep(0, nobs),
"MatID" = rep(0, nobs), "Sex" = rep(0, nobs), "Phenotype" = ophi_code$day_falling)
library(stringr)
raw <- read.csv("raw.csv", row.names = 1, header = TRUE)[1:288, ]
row.names(raw) <- str_replace_all(row.names(raw), "Ophi ", "")
row.names(raw)[14] <- 14
nobs <- length(row.names(raw))
# PED file
ped_temp <- data.frame("FID" = as.numeric(row.names(raw)), "IID" = as.numeric(row.names(raw)), "PatID" = rep(0, nobs),
"MatID" = rep(0, nobs), "Sex" = rep(0, nobs), "Phenotype" = ophi_code$day_falling)
ped <- cbind(ped_temp, raw)
write.table(ped, "ophi.ped", row.names = FALSE)
# MAP file
map <- data.frame("Chr" = rep(0, nobs), "FID" = as.numeric(row.names(raw)), "gendist" = rep(0, nobs), "snppos" = rep(-1, nobs) )
write.table(map, "ophi.map", row.names = FALSE)
library(stringr)
raw <- read.csv("raw.csv", row.names = 1, header = TRUE)[1:288, ]
row.names(raw) <- str_replace_all(row.names(raw), "Ophi ", "")
row.names(raw)[14] <- 14
nobs <- length(row.names(raw))
# PED file
ped_temp <- data.frame("FID" = as.numeric(row.names(raw)), "IID" = as.numeric(row.names(raw)), "PatID" = rep(0, nobs),
"MatID" = rep(0, nobs), "Sex" = rep(0, nobs), "Phenotype" = ophi_code$day_falling)
ped <- cbind(ped_temp, raw)
ped
head(ped)
write.table(ped, "ophi.ped", row.names = FALSE, names = FALSE)
?write.table
write.table(ped, "ophi.ped", row.names = FALSE, col.names = FALSE)
# MAP file
map <- data.frame("Chr" = rep(0, nobs), "FID" = as.numeric(row.names(raw)), "gendist" = rep(0, nobs), "snppos" = rep(-1, nobs) )
View(map)
str(ped)
nsnps <- length(names(raw))
nsnps <- length(names(raw))/2
View(fulltab_code_aic)
snp_names <- read.csv("snp_names.csv")
snp_names
map <- data.frame("Chr" = rep(0, nsnps), "FID" = snp_names, "gendist" = rep(0, nobs), "snppos" = rep(-1, nobs) )
nsnps <- length(names(raw))/2
map <- data.frame("Chr" = rep(0, nsnps), "FID" = snp_names, "gendist" = rep(0, nsnps), "snppos" = rep(-1, nsnps) )
names(raw)
snp_names
names(raw)
snp_names
library(stringr)
?str_str
?str_str<-
str_sub
?str_sub
str_sub(names(raw)[1], 1, -2)
str_sub(names(raw), 1, -2)
names_raw <- str_sub(names(raw), 1, -2)
nsnps
snp_names %in% names_raw
names_raw %in% snp_names
snp_names
snp_names <- as.character(snp_names[1])
snp_names
snp_names <- read.csv("snp_names.csv")
snps <- snp_names[1]
snps <- snp_names[, 1]
snps
as.character(snps)
snps <- as.character(snps)
snp_names <- read.csv("snp_names.csv", header = FALSE)
row.names(raw) <- str_replace_all(row.names(raw), "Ophi ", "")
row.names(raw)[14] <- 14
nobs <- length(row.names(raw))
nsnps <- length(names(raw))/2
# PED file
ped_temp <- data.frame("FID" = as.numeric(row.names(raw)), "IID" = as.numeric(row.names(raw)), "PatID" = rep(0, nobs),
"MatID" = rep(0, nobs), "Sex" = rep(0, nobs), "Phenotype" = ophi_code$day_falling)
ped <- cbind(ped_temp, raw)
write.table(ped, "ophi.ped", row.names = FALSE, col.names = FALSE)
# MAP file
map <- data.frame("Chr" = rep(0, nsnps), "FID" = snp_names, "gendist" = rep(0, nsnps), "snppos" = rep(-1, nsnps) )
write.table(map, "ophi.map", row.names = FALSE)
map <- data.frame("Chr" = rep(0, nsnps), "FID" = snp_names, "gendist" = rep(0, nsnps), "snppos" = rep(9999, nsnps) )
write.table(map, "ophi.map", row.names = FALSE)
ophi_phen <- data.frame("FID" = as.numeric(row.names(raw)), "IID" = as.numeric(row.names(raw)), "Phenotype" = ophi_code$day_falling)
write.table(ophi_phen, "ophi.phen", row.names =FALSE, col.names = FALSE)
1024*12
1024*12 + 0.3*12288
